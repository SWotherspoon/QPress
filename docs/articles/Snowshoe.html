<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snowshoe hare example analyses â€¢ QPress</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Snowshoe hare example analyses">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">QPress</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Mesocosm.html">Mesocosm example analyses</a>
    </li>
    <li>
      <a href="../articles/Snowshoe.html">Snowshoe hare example analyses</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="Snowshoe_files/htmlwidgets-1.0/htmlwidgets.js"></script><script src="Snowshoe_files/viz-0.3/viz.js"></script><link href="Snowshoe_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="Snowshoe_files/grViz-binding-1.0.1/grViz.js"></script><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Snowshoe hare example analyses</h1>
                        <h4 class="author">Jessica Melbourne-Thomas, Ben Raymond, Andrew Constable, Simon Wotherspoon</h4>
            
            <h4 class="date">2013</h4>
          </div>

    
    
<div class="contents">
<style>table tr.even { background-color: inherit; } .caption { margin-bottom: 30px; }</style>
<p>The <code>QPress</code> package provides facilities for qualitatively modelling the impact of a press perturbation upon a network model. This document illustrates the basic features of the package through a simple example.</p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <code>QPress</code> package provides facilities for qualitatively modelling the impact of a press perturbation upon a network model in the style of Melbourne-Thomas et al. <span class="citation">(<a href="#ref-JMT2012">2012</a>)</span>.</p>
<p>In this document we illustrate some of the basic facilities provided by the package using the Snowshoe hare example from Dambacher and Ramos-Jiliberto <span class="citation">(<a href="#ref-Dambacher2007">2007</a>)</span>.</p>
<p>Dambacher and Ramos-Jiliberto <span class="citation">(<a href="#ref-Dambacher2007">2007</a>)</span> describes five alternative models for the interactions between the snowshoe hare, its major predator and the supporting vegetation. These five models are reproduced in Table 1, and show the interactions of the hare <span class="math inline">\(H\)</span> with the vegetation <span class="math inline">\(V\)</span> and predator <span class="math inline">\(P\)</span>.</p>
<table class="table"><tbody>
<tr class="odd">
<td>Model A</td>
<td>
<div id="htmlwidget-03b9ed177cbb89ae1979" style="width:300px;height:150px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-03b9ed177cbb89ae1979">{"x":{"diagram":"digraph modelA {\nrankdir=LR;\nnode [shape=circle];\nV;H;P\nedge [arrowhead=dot];\nV->V\nP->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->H\nH->P\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</td>
</tr>
<tr class="even">
<td>Model B</td>
<td>
<div id="htmlwidget-15929f2ea27690ca79b3" style="width:300px;height:150px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-15929f2ea27690ca79b3">{"x":{"diagram":"digraph modelB {\nrankdir=LR;\nnode [shape=circle];\nV;H;P\nedge [arrowhead=dot];\nV->V\nP->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->H\nH->P\nedge [arrowhead=normal arrowtail=none];\nV->P\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</td>
</tr>
<tr class="odd">
<td>Model C</td>
<td>
<div id="htmlwidget-d43ea85b97ad17da0071" style="width:300px;height:150px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-d43ea85b97ad17da0071">{"x":{"diagram":"digraph modelC {\nrankdir=LR;\nnode [shape=circle];\nV;H;P\nedge [arrowhead=dot];\nV->V\nP->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->H\nH->P\nedge [arrowhead=normal arrowtail=none];\nV->P\nedge [arrowhead=dot];\nH->H\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</td>
</tr>
<tr class="even">
<td>Model D</td>
<td>
<div id="htmlwidget-1b0092b940c1c16cf297" style="width:300px;height:150px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b0092b940c1c16cf297">{"x":{"diagram":"digraph modelD {\nrankdir=LR;\nnode [shape=circle];\nV;H;P\nedge [arrowhead=dot];\nV->V\nP->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->H\nH->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->P\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</td>
</tr>
<tr class="odd">
<td>Model E</td>
<td>
<div id="htmlwidget-48387f5c67a9676a1a3d" style="width:300px;height:150px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-48387f5c67a9676a1a3d">{"x":{"diagram":"digraph modelE {\nrankdir=LR;\nnode [shape=circle];\nV;H;P\nedge [arrowhead=dot];\nV->V\nP->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->H\nH->P\nedge [dir=both arrowhead=normal arrowtail=dot];\nV->P\nedge [arrowhead=dot arrowtail=none];\nH->H\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</td>
</tr>
</tbody></table>
<p><strong>Table 1:</strong> Alternate models for the snowshoe hare system.</p>
</div>
<div id="model-definition" class="section level2">
<h2 class="hasAnchor">
<a href="#model-definition" class="anchor"></a>Model Definition</h2>
<p>The first step of any analysis is to define an appropriate model structure.</p>
<p>A directed graph representation of a model may be constructed from simple textual description with the <code>parse.digraph</code> and <code>read.digraph</code> functions. The <code>parse.digraph</code> allows the edges of the graph to be specified as a vector of character strings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(QPress)

## Read a textual model description
modelA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">parse.digraph</a></span>(<span class="kw">c</span>(<span class="st">"V-*V"</span>, <span class="st">"P-*P"</span>, <span class="st">"V*-&gt;H"</span>, <span class="st">"H*-&gt;P"</span>))</code></pre></div>
<p>Alternately, the edge descriptions can be stored in a text file, one edge per line, and read and written with <code>read.digraph</code> and <code>write.digraph</code> respectively</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Write/read a model description to a text file
<span class="kw"><a href="../reference/read.digraph.html">write.digraph</a></span>(modelA,<span class="st">"modelA.txt"</span>)
modelA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">read.digraph</a></span>(<span class="st">"modelA.txt"</span>)</code></pre></div>
<p>Within R, the graph is represented as an edge list, a dataframe of directed edges.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelA
<span class="co">#&gt;   From To Group Type Pair</span>
<span class="co">#&gt; 1    V  V     0    N    1</span>
<span class="co">#&gt; 2    P  P     0    N    2</span>
<span class="co">#&gt; 3    V  H     0    P    3</span>
<span class="co">#&gt; 4    H  P     0    P    4</span>
<span class="co">#&gt; 7    H  V     0    N    3</span>
<span class="co">#&gt; 8    P  H     0    N    4</span></code></pre></div>
<p>This dataframe records the nodes connected by the directed edge (<code>To</code> and <code>From</code>), whether the edge represents a positive (P) or negative (N) impact (<code>Type</code>), and which edges were paired in the original specification (<code>Pair</code>). As will be demonstrated below, it also it is possible to group edges (<code>Group</code>). For example, the edge connecting <span class="math inline">\(V\)</span> and <span class="math inline">\(H\)</span> in model A has been separated into the positive impact of <span class="math inline">\(V\)</span> upon <span class="math inline">\(H\)</span>, and the negative impact of <span class="math inline">\(H\)</span> upon <span class="math inline">\(V\)</span>.</p>
<p>Models B to E may be defined similarly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelB &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">parse.digraph</a></span>(<span class="kw">c</span>(<span class="st">"V-*V"</span>, <span class="st">"P-*P"</span>, <span class="st">"V*-&gt;H"</span>, <span class="st">"H*-&gt;P"</span>, <span class="st">"V-&gt;P"</span>))
modelC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">parse.digraph</a></span>(<span class="kw">c</span>(<span class="st">"V-*V"</span>, <span class="st">"H-*H"</span>, <span class="st">"P-*P"</span>, <span class="st">"V*-&gt;H"</span>, <span class="st">"H*-&gt;P"</span>, <span class="st">"V-&gt;P"</span>))
modelD &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">parse.digraph</a></span>(<span class="kw">c</span>(<span class="st">"V-*V"</span>, <span class="st">"P-*P"</span>, <span class="st">"V*-&gt;H"</span>, <span class="st">"H*-&gt;P"</span>, <span class="st">"V*-&gt;P"</span>))
modelE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">parse.digraph</a></span>(<span class="kw">c</span>(<span class="st">"V-*V"</span>, <span class="st">"H-*H"</span>, <span class="st">"P-*P"</span>, <span class="st">"V*-&gt;H"</span>, <span class="st">"H*-&gt;P"</span>, <span class="st">"V*-&gt;P"</span>))</code></pre></div>
<p>It is also possible to combine these four models into one “super” model using the mechanism of uncertain edges. Edges are allocated into groups according to the number of dashes in their text definition or the line style in their Dia definition. The (directed) edges common to the four models are specified as one group, and the disjoint edges as a second.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Model with uncertain edges
modelBCDE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.digraph.html">parse.digraph</a></span>(<span class="kw">c</span>(<span class="st">"V-*V"</span>, <span class="st">"P-*P"</span>, <span class="st">"V*-&gt;H"</span>, <span class="st">"H*-&gt;P"</span>, <span class="st">"V-&gt;P"</span>, <span class="st">"H--*H"</span>, <span class="st">"V*--P"</span>))
modelBCDE
<span class="co">#&gt;    From To Group Type Pair</span>
<span class="co">#&gt; 1     V  V     0    N    1</span>
<span class="co">#&gt; 2     P  P     0    N    2</span>
<span class="co">#&gt; 3     V  H     0    P    3</span>
<span class="co">#&gt; 4     H  P     0    P    4</span>
<span class="co">#&gt; 5     V  P     0    P    5</span>
<span class="co">#&gt; 6     H  H     1    N    6</span>
<span class="co">#&gt; 10    H  V     0    N    3</span>
<span class="co">#&gt; 11    P  H     0    N    4</span>
<span class="co">#&gt; 14    P  V     1    N    7</span></code></pre></div>
<p>When simulating from this super model, edges from the first group (group 0) can be treated as “required” and then will be included in all simulations, while second group (group 1) can be treated as “uncertain”, and included or excluded at random.</p>
<p>Many models will not be stable unless the majority of nodes are self limiting. The <code>enforce.limitations</code> function adds a self limiting edge to every node. So models C and E could be obtained from models B and D as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add self-limitation to all nodes
modelC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/enforce.limitation.html">enforce.limitation</a></span>(modelB)
modelE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/enforce.limitation.html">enforce.limitation</a></span>(modelD)</code></pre></div>
<p>The adjacency matrix can be constructed from the edge list with the <code>adjacency.matrix</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/adjacency.matrix.html">adjacency.matrix</a></span>(modelA, <span class="dt">labels =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt;    H  P  V</span>
<span class="co">#&gt; H  0 -1  1</span>
<span class="co">#&gt; P  1 -1  0</span>
<span class="co">#&gt; V -1  0 -1</span></code></pre></div>
</div>
<div id="high-level-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#high-level-simulation" class="anchor"></a>High Level Simulation</h2>
<p>Many analyses can be performed with the high level simulation function <code>system.simulate</code>. This function simulates random community matrices that:</p>
<ul>
<li>are consistent with the given signed directed graph,</li>
<li>correspond to a system with a stable equilibrium, and optionally</li>
<li>are consistent with a set of validation criteria,</li>
</ul>
<p>and returns the negative inverses and the non-zero elements of the simulated community matrices. The properties of these simulated matrices can be interactively explored with the <code>impact.barplot</code> and <code>weight.density</code> functions.</p>
<p>Dambacher and Ramos-Jiliberto <span class="citation">(<a href="#ref-Dambacher2007">2007</a>)</span> note that model A predicts that a positive press perturbation of the vegetation always results in an increase in hare numbers, yet manipulation experiments have shown that this is not always the case, suggesting that model A is not an adequate description of the physical system.</p>
<p>To show that model A predicts an increase in hare numbers following a positive press perturbation of the vegetation, we simulate 1000 community matrices corresponding to model A:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelA)</code></pre></div>
<p>and explore the simulations with <code>impact.barplot</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/impact.barplot.html">impact.barplot</a></span>(simA)</code></pre></div>
<p>This creates an interactive control panel that allows the user to specify a press perturbation and optionally a validation criterion, and then displays the impact of the perturbation on each node as a barplot. This plot shows the fraction of positive (orange), zero (brown), and negative (blue) outcomes at each node. Selecting a positive (<code>+</code>) perturbation of the <span class="math inline">\(V\)</span> node in the perturbation panel, and pressing the update button produces the first barplot shown in Figure 1. This plot shows that a positive press perturbation to the vegetation always has a positive impact at each node.</p>
<p>Repeating this process for model B</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simB &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelB)
<span class="kw"><a href="../reference/impact.barplot.html">impact.barplot</a></span>(simB)</code></pre></div>
<p>produces the second barplot in in Figure 1. This shows that for model B, almost 40% of the community matrices simulated yield a decrease in hare numbers following a positive press perturbation to the vegetation.</p>
<p>The <code>impact.barplot</code> function takes a second argument <code>epsilon</code> that controls sensitivity to change — outcomes smaller than <code>epsilon</code> are treated as zero. The third barplot in in Figure 1 shows the result of simulating from the combined model BCDE and applying a positive press perturbation to V, but treating changes to the equilibrium value of less than 5% as neglible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simBCDE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelBCDE)
<span class="kw"><a href="../reference/impact.barplot.html">impact.barplot</a></span>(simBCDE, <span class="dt">epsilon =</span> <span class="fl">0.05</span>)</code></pre></div>
<p>We can limit the plot to just those cases in which hares decrease in response to the perturbation applied to <span class="math inline">\(V\)</span> by selecting a negative (<code>-</code>) for the <span class="math inline">\(H\)</span> node in the monitor panel. This yields the fourth barplot in in Figure 1.</p>
<div class="figure">
<img src="Snowshoe_files/figure-html/fig1-1.png" alt="**Figure 1** Model outcomes in response to a positive press perturbation to the vegetation. Each plot shows the fraction of positive (orange), zero (brown), and negative (blue) outcomes at each node following a positive press perturbation to the vegetation." width="576"><p class="caption">
<strong>Figure 1</strong> Model outcomes in response to a positive press perturbation to the vegetation. Each plot shows the fraction of positive (orange), zero (brown), and negative (blue) outcomes at each node following a positive press perturbation to the vegetation.
</p>
</div>
<p>The <code>weight.density</code> function can be used to explore the magnitude of the edge weights (model interaction strengths) associated with a particular outcomes. For example, the call</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/weight.density.html">weight.density</a></span>(simBCDE)</code></pre></div>
<p>produces an interactive control panel that allows the user to specify a press perturbation, an observed outcome, and a subset of edges. For ease of identification, the edge selection panel is laid out in the same structure as the adjacency matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/adjacency.matrix.html">adjacency.matrix</a></span>(modelBCDE, <span class="dt">required.groups =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>)
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]   -1   -1    1</span>
<span class="co">#&gt; [2,]    1   -1    1</span>
<span class="co">#&gt; [3,]   -1   -1   -1</span></code></pre></div>
<p>The community matrices simulated from the model are classified as either consistent or inconsistent with the observed outcome given the specified press perturbation, and for each selected edge, density plots of the edge weights are produced for the two groups of matrices. For matrices consistent with the observed outcome, the density of edge weights is shown in blue, while for those inconsistent with the observed outcome, the density of edge weights is shown in red. For readability, the plots are labelled by the indices that edge would have in the adjacency matrix.</p>
<p>For the simulated matrices from model BCDE, selecting a positive (<code>+</code>) perturbation of the <span class="math inline">\(V\)</span> node in the perturbation panel, and negative (<code>-</code>) outcome for <span class="math inline">\(H\)</span> in the monitor panel and selecting all edges produces the suite of density plots shown in Figure 2. Each plot in the figure corresponds to an edge of model BCDE, and the blue lines show the density of the edge weights where hares decreased, while the red lines show the density of edge weights where hares increased. So for example, the plot labelled 2:2 corresponds to the self limiting edge on <span class="math inline">\(P\)</span>, and shows that decreases in hare numbers following a positive press perturbation to vegetation is associated with stronger self limitation of the predator.</p>
<div class="figure">
<img src="Snowshoe_files/figure-html/fig2-1.png" alt="**Figure 2:** Edge weight density plots for a decrease in hares following a positive press perturbation to vegetation in model BCDE. Each plot corresponds to an edge, and shows the distribution of edge weights when hares decrease (blue) and when hares increase (red)." width="576"><p class="caption">
<strong>Figure 2:</strong> Edge weight density plots for a decrease in hares following a positive press perturbation to vegetation in model BCDE. Each plot corresponds to an edge, and shows the distribution of edge weights when hares decrease (blue) and when hares increase (red).
</p>
</div>
<p>More complex validation criteria can be specified by passing validation functions generated by <code>press.validate</code> to <code>system.simulate</code> directly. For example, the call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Simulate 1000 community matrices from the uncertain model, st
## 1. A positive perturbation of P leads to a reduction in H
## 2. A positive perturbation of V leads to an increase in V
simBCDE1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelBCDE,
                            <span class="dt">validators =</span> <span class="kw">list</span>(
                              <span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelBCDE,
                                             <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">P =</span> <span class="dv">1</span>),
                                             <span class="dt">monitor =</span> <span class="kw">c</span>(<span class="dt">H =</span> <span class="op">-</span><span class="dv">1</span>)),
                              <span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelBCDE,
                                             <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>),
                                             <span class="dt">monitor =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>))))</code></pre></div>
<p>simulates community matrices consistent with model BCDE that satisfy the validation criteria that hares decrease following a positive press perturbation of the predators, and vegetation increases following a press perturbation of vegetation. As <code>system.simulate</code> attempts to generate a fixed number of matrices, the simulation may fail to terminate of too stringent a validation criteria is set.</p>
<p>Competing models can be compared based on the frequency with which the models reproduce an observed outcome. At a simple level, the more frequently a model reproduces a observed outcome, the more likely the model is correct. This notion can be embedded within Bayesian framework to produce a formal system of model comparison. Suppose a positive press perturbation of vegetation is observed to produce a decrease in hare numbers. It is believed that the system can be described by model B, C, D, or E, but it is believed that models D and E are slightly more plausible than models B and C. Models B and C are both assigned prior probabilities of <span class="math inline">\(4/16\)</span> and models D and E are assigned prior probabilities of <span class="math inline">\(5/16\)</span> each.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prior &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">B=</span><span class="dv">3</span><span class="op">/</span><span class="dv">16</span>,<span class="dt">C=</span><span class="dv">3</span><span class="op">/</span><span class="dv">16</span>,<span class="dt">D=</span><span class="dv">5</span><span class="op">/</span><span class="dv">16</span>,<span class="dt">E=</span><span class="dv">5</span><span class="op">/</span><span class="dv">16</span>)</code></pre></div>
<p>The marginal likelihood of each model is the fraction of simulate community matrices that yield an prediction consistent with the observed impact:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Compute the likelihood for each model
simB &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelB,
                        <span class="dt">validators=</span><span class="kw">list</span>(
                          <span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelB, <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>),
                                                 <span class="dt">monitor =</span> <span class="kw">c</span>(<span class="dt">H =</span> <span class="op">-</span><span class="dv">1</span>))))
simC &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelC, 
                        <span class="dt">validators=</span><span class="kw">list</span>(
                          <span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelC, <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>),
                                                 <span class="dt">monitor =</span> <span class="kw">c</span>(<span class="dt">H =</span> <span class="op">-</span><span class="dv">1</span>))))
simD &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelD,
                        <span class="dt">validators=</span><span class="kw">list</span>(
                          <span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelD, <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>),
                                                 <span class="dt">monitor =</span> <span class="kw">c</span>(<span class="dt">H =</span> <span class="op">-</span><span class="dv">1</span>))))
simE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, modelE,
                        <span class="dt">validators=</span><span class="kw">list</span>(
                          <span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelE, <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>),
                                                 <span class="dt">monitor =</span> <span class="kw">c</span>(<span class="dt">H =</span> <span class="op">-</span><span class="dv">1</span>))))

likelihood &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">B =</span> simB<span class="op">$</span>accepted <span class="op">/</span><span class="st"> </span>simB<span class="op">$</span>total,
                <span class="dt">C =</span> simC<span class="op">$</span>accepted <span class="op">/</span><span class="st"> </span>simC<span class="op">$</span>total,
                <span class="dt">D =</span> simD<span class="op">$</span>accepted <span class="op">/</span><span class="st"> </span>simD<span class="op">$</span>total,
                <span class="dt">E =</span> simE<span class="op">$</span>accepted <span class="op">/</span><span class="st"> </span>simE<span class="op">$</span>total)</code></pre></div>
<p>The posterior probabilities for the four models are then</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">posterior &lt;-<span class="st"> </span>prior <span class="op">*</span><span class="st"> </span>likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prior<span class="op">*</span>likelihood)
posterior
<span class="co">#&gt;         B         C         D         E </span>
<span class="co">#&gt; 0.1482024 0.1881286 0.2792648 0.3844042</span></code></pre></div>
<p>suggesting that model E is the most likely model.</p>
</div>
<div id="low-level-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#low-level-simulation" class="anchor"></a>Low Level Simulation</h2>
<p>The <code>system.simulate</code> function is a wrapper for the lower level functions <code>community.sampler</code>, <code>stable.community</code>, <code>press.validate</code> and <code>press.impact</code>. More flexible simulations can be constructed in terms of these primitives.</p>
<p>The <code>community.sampler</code> function constructs functions for sampling community matrices from a given model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw"><a href="../reference/community.sampler.html">community.sampler</a></span>(modelBCDE)</code></pre></div>
<p>This returns a list with components <code>select</code>, <code>community</code>, <code>weights</code>, <code>weight.labels</code> and <code>uncertain.labels</code>. The <code>select</code> component randomly selects which uncertain edges will be included or excluded from the model in subsequent simulations. This is a function takes as single argument the probability with which any uncertain edge is to be retained in the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Select uncertain edges
s<span class="op">$</span><span class="kw">select</span>(<span class="dt">p=</span><span class="fl">0.5</span>)</code></pre></div>
<p>This function returns a vector that indicates which uncertain edges have been retained. The <code>community</code> component generates a random community matrix consistent with the model and the selected of uncertain edges:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">W &lt;-<span class="st"> </span>s<span class="op">$</span><span class="kw">community</span>()
W
<span class="co">#&gt;            [,1]       [,2]       [,3]</span>
<span class="co">#&gt; [1,] -0.4545210 -0.6312181  0.4460041</span>
<span class="co">#&gt; [2,]  0.2200059 -0.8027115  0.2359806</span>
<span class="co">#&gt; [3,] -0.3911064  0.0000000 -0.5199113</span></code></pre></div>
<p>The non-zero elements of this matrix can be extracted with the <code>weights</code> element:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s<span class="op">$</span><span class="kw">weights</span>(W)
<span class="co">#&gt; [1] -0.5199113 -0.8027115  0.4460041  0.2200059  0.2359806 -0.4545210</span>
<span class="co">#&gt; [7] -0.3911064 -0.6312181  0.0000000</span></code></pre></div>
<p>and the corresponding edge labels, and the labels of the uncertain edges are given by <code>weight.labels</code> and <code>uncertain.labels</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s<span class="op">$</span>weight.labels
<span class="co">#&gt; [1] "V -* V" "P -* P" "V -&gt; H" "H -&gt; P" "V -&gt; P" "H -* H" "H -* V" "P -* H"</span>
<span class="co">#&gt; [9] "P -* V"</span>
s<span class="op">$</span>uncertain.labels
<span class="co">#&gt; [1] "H -* H" "P -* V"</span></code></pre></div>
<p>The <code>stable.community</code> function determines whether community matrix corresponds to a system with a stable equilibrium:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/stable.community.html">stable.community</a></span>(W)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>The <code>press.impact</code> function constructs a function to compute the impact of a system to a given press perturbation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Evaluate impact of a perturbation to V
impact &lt;-<span class="st"> </span><span class="kw"><a href="../reference/press.impact.html">press.impact</a></span>(modelBCDE, <span class="dt">perturb =</span> <span class="kw">c</span>(<span class="dt">V =</span> <span class="dv">1</span>))
<span class="kw">impact</span>(W)
<span class="co">#&gt; [1] 0.6083370 0.5976411 1.4657799</span>
<span class="kw"><a href="../reference/signum.html">signum</a></span>(<span class="kw">impact</span>(W))
<span class="co">#&gt; [1] 1 1 1</span></code></pre></div>
<p>The <code>press.validate</code> function constructs a function to determine whether a community matrix satisfies a given validation criterion:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## a positive perturbation to V should produce a reduction in H
g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/press.validate.html">press.validate</a></span>(modelBCDE,<span class="dt">perturb=</span><span class="kw">c</span>(<span class="dt">V=</span><span class="dv">1</span>),<span class="dt">monitor=</span><span class="kw">c</span>(<span class="dt">H=</span><span class="op">-</span><span class="dv">1</span>))
<span class="kw">g</span>(W)
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Dambacher2007">
<p>Dambacher, Jeffrey M, and Rodrigo Ramos-Jiliberto. 2007. “Understanding and Predicting Effects of Modified Interactions Through a Qualitative Analysis of Community Structure.” <em>The Quarterly Review of Biology</em> 82 (3). JSTOR: 227–50.</p>
</div>
<div id="ref-JMT2012">
<p>Melbourne-Thomas, J, S Wotherspoon, B Raymond, and A Constable. 2012. “Comprehensive Evaluation of Model Uncertainty in Qualitative Network Analyses.” <em>Ecological Monographs</em> 82 (4). Eco Soc America: 505–19.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#model-definition">Model Definition</a></li>
      <li><a href="#high-level-simulation">High Level Simulation</a></li>
      <li><a href="#low-level-simulation">Low Level Simulation</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Simon Wotherspoon, Jessica Melbourne-Thomas, Ben Raymond.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
