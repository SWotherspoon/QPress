<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mesocosm example analyses â€¢ QPress</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Mesocosm example analyses">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">QPress</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Mesocosm.html">Mesocosm example analyses</a>
    </li>
    <li>
      <a href="../articles/Snowshoe.html">Snowshoe hare example analyses</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Mesocosm example analyses</h1>
                        <h4 class="author">Jessica Melbourne-Thomas, Ben Raymond, Andrew Constable, Simon Wotherspoon</h4>
            
            <h4 class="date">2013</h4>
          </div>

    
    
<div class="contents">
<style>table tr.even { background-color: inherit; }</style>
<p>The <code>QPress</code> package provides facilities for qualitatively modelling the impact of a press perturbation upon a network model. This document illustrates the comparison of alternative models in terms of their responses to perturbation. Two examples are provided for experimental mesocosms in (I) a lake environment <span class="citation">(Hulot et al. <a href="#ref-Hulot2000">2000</a>)</span>, and (II) Antarctica (Davidson et al. unpublished).</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>An experimental mesocosm is an ecological tool that enables the experimenter to assess assemblage-level responses to environmental change. Mesocosm experiments are performed in the `natural environment’ rather than in a laboratory, but in an enclosure that is small enough that key variables can be directly controlled. Because the responses of component species to perturbation can be observed directly in a mesocosm setting, the results from such studies lend themselves to analysis using qualitative network modelling. In particular, these analyses can be used to make inferences regarding the trophic and competitive interactions that drive assemblage-level responses to perturbation in a mesocosm setting and potentially more broadly.</p>
<p>In this document we use the <code>QPress</code> package to analyse two sets of models corresponding to two separate mesocosm experiments. Example I is for experimental mesocosms in a lake in France that were subjected to high and low nutrient treatments <span class="citation">(Hulot et al. <a href="#ref-Hulot2000">2000</a>)</span>. Example II examines the effects of elevated concentrations of CO<span class="math inline">\(_2\)</span> on the Southern Ocean microbial loop, studied in environmentally controlled tanks (referred to as `minicosms’ by the authors) in Antarctica (Davidson et al. unpublished).</p>
</div>
<div id="example-i-lake-mesocosm" class="section level1">
<h1 class="hasAnchor">
<a href="#example-i-lake-mesocosm" class="anchor"></a>Example I: Lake mesocosm</h1>
<p>Hulot et al. <span class="citation">(<a href="#ref-Hulot2000">2000</a>)</span> describe an eight-variable lake mesocosm model comprising phosphorous, three algal groups, two size-classes of herbivores, invertebrate carnivores and carnivorous fish (Figure 1). Unambiguous, directional responses of model components to increased phosphorous observed in the mesocosm experiment were increases in each of: phosphorous (Phos), large herbivores (Herb2), fish (Carn2) and periphyton (AlgP). Melbourne-Thomas et al. <span class="citation">(<a href="#ref-JMT2012">2012</a>)</span> compare the ability of Hulot et al.’s original model (Figure 1a) and a variant of the model with one edge added and one edge deleted (Figure 1b) to reproduce these changes in response to a positive perturbation to phosphorous. Specifically, the variant model (Figure 1b) includes a self-limitation effect for invertebrate carnivores, and the predator-prey edge from fish to invertebrate carnivores has been deleted.</p>
<figure><img src="Lake.png" width="100%" alt="Figure 1" align="center"><figcaption><strong>Figure 1:</strong> Two versions of the eight-variable lake mesocosm model analyzed by Melbourne-Thomas et al. <span class="citation">(<a href="#ref-JMT2012">2012</a>)</span> and Hosack et al. <span class="citation">(<a href="#ref-Hosack2008">2008</a>)</span>, and originally presented by Hulot et al. <span class="citation">(<a href="#ref-Hulot2000">2000</a>)</span>. Abbreviations are: Alg1, edible algae; Alg2, protected algae; AlgP, periphyton; Carn1, invertebrate carnivores; Carn2, fish; Herb1, small herbivores; Herb2, large herbivores; Phos, phosphorus.
</figcaption></figure><p>The models shown in Figure 1 were created using Dia and so are read using <code>model.dia</code>. Here we assign the two model objects to <code>lake.a</code> and <code>lake.b</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(QPress)
lake.a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.dia.html">model.dia</a></span>(<span class="st">"Lake-a.dia"</span>)
lake.b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.dia.html">model.dia</a></span>(<span class="st">"Lake-b.dia"</span>)</code></pre></div>
<p>We then simulate for model (a) and use <code>impact.barplot</code> to view simulation outcomes corresponding with observations from the mesocosm experiment (Figure 2).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simlake.a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, lake.a)
<span class="kw"><a href="../reference/impact.barplot.html">impact.barplot</a></span>(simlake.a)</code></pre></div>
<p>Doing the same for model (b) gives Figure 3.</p>
<figure><img src="Lake-selector.png" width="60%" alt="Figure 2" align="center"><figcaption><strong>Figure 2:</strong> Node selector for the lake mesocosm example.
</figcaption></figure><div class="figure">
<img src="Mesocosm_files/figure-html/outc1-1.png" alt='**Figure 3:** Simulation outcomes from the two lake mesocosm models in response to a positive press perturbation to phosphorous. Each plot shows the fraction of positive (orange), and negative (blue) outcomes at each node. The x-axis indicates the number of simulations (out of 1000 total) that match with the selection for "Monitor" shown in Figure 2.' width="768"><p class="caption">
<strong>Figure 3:</strong> Simulation outcomes from the two lake mesocosm models in response to a positive press perturbation to phosphorous. Each plot shows the fraction of positive (orange), and negative (blue) outcomes at each node. The x-axis indicates the number of simulations (out of 1000 total) that match with the selection for “Monitor” shown in Figure 2.
</p>
</div>
<p>Approximately 50% of the simulations match with observations for model (a), whereas for model (b) this increases to over 80%. This suggests that model (b) provides a more parsimonious representation of the lake mesocosm system. Melbourne-Thomas et al. <span class="citation">(<a href="#ref-JMT2012">2012</a>)</span> provide a direct comparison of the two models using Bayes factors.</p>
</div>
<div id="example-ii-antarctic-mesocosm" class="section level1">
<h1 class="hasAnchor">
<a href="#example-ii-antarctic-mesocosm" class="anchor"></a>Example II: Antarctic mesocosm</h1>
<p>This example is based on experiments conducted at Australia’s Davis Station in Antarctica, which assessed the responses of a natural community of Antarctic marine microbes from near-shore waters to elevated concentrations of CO<span class="math inline">\(_2\)</span> using environmentally controlled tanks (mesocosms). Davidson et al. (in prep) describe the main components of the Southern Ocean microbial loop represented in these mesocosms and the ecological interactions between them. Specifically:</p>
<ul>
<li>Small and large phytoplankton cells consume macronutrients and iron (Fe), although iron is potentially less important for growth of small phytoplankton;</li>
<li>Small phytoplankton are consumed by heterotrophic nanoflagellates and microzooplankton;</li>
<li>Large phytoplankton (diatoms) are consumed by microzooplankton;</li>
<li>Bacteria break down DOC (dissolved organic carbon) and are consumed by heterotrophic nanoflagellates;</li>
<li>Phytoplankton, microzooplankton and heterotrophic nanoflagellates supply the DOC pool.</li>
</ul>
<p>These interactions are represented in a model that was built using Dia (black-coloured edges in Figure 4).</p>
<p>When this system was subjected to elevated CO<span class="math inline">\(_2\)</span> concentrations in experimental mesocosms, the following responses were observed:</p>
<ul>
<li>Small phytoplankton increased;</li>
<li>Large phytoplankton decreased;</li>
<li>Heterotrophic nanoflagellates decreased; and</li>
<li>Bacteria increased.</li>
</ul>
<p>In the model shown in Figure 4 we assume that the direct effects of CO<span class="math inline">\(_2\)</span> correspond with these observed changes.</p>
<figure><img src="Antarctic-a.png" width="100%" alt="Figure 4" align="center"><figcaption><strong>Figure 4:</strong> Model (a) representing the effects of CO<span class="math inline">\(_2\)</span> on the Southern Ocean microbial loop, determined directly from observed responses in experimental mesocosms. These direct effects are shown in red.
</figcaption></figure><p>We then analyse the response this model to a positive press perturbation to CO<span class="math inline">\(_2\)</span>. In this case we enforce a specific ordering of the nodes, and also enforce self-limitation for each model variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"CO2"</span>, <span class="st">"Fe"</span>, <span class="st">"Macronutrients"</span>, <span class="st">"Small phytoplankton"</span>, <span class="st">"Large phytoplankton"</span>,
            <span class="st">"Heterotrophic nanoflagellates"</span>, <span class="st">"Microzooplankton"</span>, <span class="st">"Bacteria"</span>, <span class="st">"DOC"</span>)
antarctic.a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.dia.html">model.dia</a></span>(<span class="st">"Antarctic-a.dia"</span>, <span class="dt">labels =</span> labels)
antarctic.a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/enforce.limitation.html">enforce.limitation</a></span>(antarctic.a)</code></pre></div>
<p>As for Example I, we then simulate and use <code>impact.barplot</code> (with the selections shown in Figure 5) to produce Figure 6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simantarctic.a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, antarctic.a)
<span class="kw"><a href="../reference/impact.barplot.html">impact.barplot</a></span>(simantarctic.a)</code></pre></div>
<figure><img src="Antarctic-selector.png" width="60%" alt="Figure 5" align="center"><figcaption><strong>Figure 5:</strong> Node selector for the Antarctic mesocosm example..
</figcaption></figure><div class="figure">
<img src="Mesocosm_files/figure-html/simanta2-1.png" alt="**Figure 6**: Simulation outcomes in response to a positive press perturbation to CO$_2$ for Antarctic mesocosm model (a). Each plot shows the fraction of positive (orange), and negative (blue) outcomes at each node." width="576"><p class="caption">
<strong>Figure 6</strong>: Simulation outcomes in response to a positive press perturbation to CO<span class="math inline">\(_2\)</span> for Antarctic mesocosm model (a). Each plot shows the fraction of positive (orange), and negative (blue) outcomes at each node.
</p>
</div>
<p>For this version of the model, less than 20% of the simulations match with our “Monitor” criteria, suggesting that it does not provide a particularly good representation of the Antarctic microbial loop system or its response to increased CO<span class="math inline">\(_2\)</span> concentrations. Given that increases in dissolved CO<span class="math inline">\(_2\)</span> are generally expected to have negative impacts of the growth of marine organisms, we could assume a direct negative effect of CO<span class="math inline">\(_2\)</span> on each of large phytoplankton, small phytoplankton, heterotrophic nanoflagellates, and also the pool of available iron (Figure 7).</p>
<figure><img src="Antarctic-b.png" width="100%" alt="Figure 7" align="center"><figcaption><strong>Figure 7:</strong> Alternative model (b) representing the effects of CO<span class="math inline">\(_2\)</span> on the Southern Ocean microbial loop.
</figcaption></figure><p>Reading this alternative representation from a Dia file</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">antarctic.b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.dia.html">model.dia</a></span>(<span class="st">"Antarctic-b.dia"</span>, <span class="dt">labels =</span> labels)
antarctic.b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/enforce.limitation.html">enforce.limitation</a></span>(antarctic.b)</code></pre></div>
<p>and exploring simulation outcomes with <code>impact.barplot</code> (with the same “Monitor” criteria as before) produces Figure 8.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simantarctic.b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/system.simulate.html">system.simulate</a></span>(<span class="dv">1000</span>, antarctic.b)
<span class="kw"><a href="../reference/impact.barplot.html">impact.barplot</a></span>(simantarctic.b)</code></pre></div>
<p>In this case, we still only see approximately 20% of simulations that meet our criteria, suggesting that we need to re-think the structure of our model. Davidson et al. (in prep) indicate that bacteria “transform dissolved organic carbon (DOC)… thereby repackaging carbon and making it available to higher trophic levels’”. Looking at our original model, we haven’t quite captured this in our representation of interactions between bacteria, DOC and macronutrients. In a third version of our microbial loop model (model (c) — Figure 9) we therefore assume a negative effect of bacteria on DOC and a positive effect of bacteria on macronutrients (which includes carbon).</p>
<p>Reading a third Dia version of the model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">antarctic.c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.dia.html">model.dia</a></span>(<span class="st">"Antarctic-c.dia"</span>, <span class="dt">labels =</span> labels)
antarctic.c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/enforce.limitation.html">enforce.limitation</a></span>(antarctic.c)</code></pre></div>
<p>and repeating the simulation and <code>impact.barplot</code> steps from above gives Figure 10.</p>
<div class="figure">
<img src="Mesocosm_files/figure-html/simantb2-1.png" alt="**Figure 8**: Simulation outcomes in response to a positive press perturbation to the CO$_2$ for the alternative microbial loop model (b) shown in Figure 7." width="576"><p class="caption">
<strong>Figure 8</strong>: Simulation outcomes in response to a positive press perturbation to the CO<span class="math inline">\(_2\)</span> for the alternative microbial loop model (b) shown in Figure 7.
</p>
</div>
<figure><img src="Antarctic-c.png" width="100%" alt="Figure 9" align="center"><figcaption><strong>Figure 9:</strong> Alternative model (c) representing the effects of CO<span class="math inline">\(_2\)</span> on the Southern Ocean microbial loop.
</figcaption></figure><div class="figure">
<img src="Mesocosm_files/figure-html/simantc2-1.png" alt="**Figure 10**: Simulation outcomes in response to a positive press perturbation to the CO$_2$ for the alternative microbial loop model (c) shown in Figure 9." width="576"><p class="caption">
<strong>Figure 10</strong>: Simulation outcomes in response to a positive press perturbation to the CO<span class="math inline">\(_2\)</span> for the alternative microbial loop model (c) shown in Figure 9.
</p>
</div>
<div id="bibliography" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h2>
<div id="refs" class="references">
<div id="ref-Hosack2008">
<p>Hosack, Geoffrey R, Keith R Hayes, and Jeffrey M Dambacher. 2008. “Assessing model structure uncertainty through an analysis of system feedback and Bayesian networks.” <em>Ecological Applications</em> 18 (4): 1070–82.</p>
</div>
<div id="ref-Hulot2000">
<p>Hulot, F D, G Lacroix, F Lescher-Moutoué, and M Loreau. 2000. “Functional diversity governs ecosystem response to nutrient enrichment.” <em>Nature</em> 405 (May): 340–44.</p>
</div>
<div id="ref-JMT2012">
<p>Melbourne-Thomas, J, S Wotherspoon, B Raymond, and A Constable. 2012. “Comprehensive Evaluation of Model Uncertainty in Qualitative Network Analyses.” <em>Ecological Monographs</em> 82 (4). Eco Soc America: 505–19.</p>
</div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#example-i-lake-mesocosm">Example I: Lake mesocosm</a></li>
      <li>
<a href="#example-ii-antarctic-mesocosm">Example II: Antarctic mesocosm</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bibliography">Bibliography</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Simon Wotherspoon, Jessica Melbourne-Thomas, Ben Raymond.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
